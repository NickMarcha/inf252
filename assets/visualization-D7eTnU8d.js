import{m as D,h as i,j as e}from"./index-Bqmpsv54.js";import{g as R,c as A,f as Y,S as P}from"./-exploration-charts-VZ8MSi80.js";const z=o=>(c,d)=>o==="title"?(c.Series_Title??"").localeCompare(d.Series_Title??""):o==="year"?Number(c.Released_Year??0)-Number(d.Released_Year??0):o==="imdb"?Number(d.IMDB_Rating??0)-Number(c.IMDB_Rating??0):o==="meta"?Number(d.Meta_score??0)-Number(c.Meta_score??0):0;function F({allMovies:o,filteredMovieIds:c,subtitle:d,sortBy:w,onSortChange:b,onMovieClick:y,selectedMovieId:p}){const k=i.useMemo(()=>{const s=o.filter(h=>c.has(h.Series_Title??"")),r=o.filter(h=>!c.has(h.Series_Title??"")),g=z(w);return[...s.sort(g),...r.sort(g)]},[o,c,w]),l=i.useMemo(()=>{const s=k.filter(n=>c.has(n.Series_Title??"")),r=s.filter(n=>n.IMDB_Rating&&!Number.isNaN(Number(n.IMDB_Rating))),g=s.filter(n=>n.Meta_score&&!Number.isNaN(Number(n.Meta_score))),h=r.length?r.reduce((n,u)=>n+Number(u.IMDB_Rating),0)/r.length:null,M=g.length?g.reduce((n,u)=>n+Number(u.Meta_score),0)/g.length:null;return{count:s.length,avgImdb:h,avgMeta:M}},[k,c]);return e.jsxs("div",{className:"flex flex-1 min-h-0 flex-col gap-3",children:[e.jsxs("div",{className:"flex shrink-0 flex-wrap items-center justify-between gap-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"mb-0.5 font-semibold text-gray-800 dark:text-gray-200",children:d}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[l.count," movie",l.count!==1?"s":"",l.avgImdb!=null&&` · Avg IMDB: ${l.avgImdb.toFixed(1)}`,l.avgMeta!=null&&` · Avg Meta: ${l.avgMeta.toFixed(1)}`]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Sort:"}),e.jsxs("select",{value:w,onChange:s=>b(s.target.value),className:"rounded border border-gray-300 bg-white px-2 py-1 text-gray-900 dark:border-gray-600 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"title",children:"Title"}),e.jsx("option",{value:"year",children:"Year"}),e.jsx("option",{value:"imdb",children:"IMDB"}),e.jsx("option",{value:"meta",children:"Meta"})]})]})]}),e.jsx("div",{className:"grid min-h-0 flex-1 grid-cols-2 gap-3 overflow-y-auto sm:grid-cols-3 md:grid-cols-4",children:k.map(s=>{const r=s.Series_Title??"",g=p!=null&&r===p,h=c.has(r);return e.jsxs("div",{role:y?"button":void 0,tabIndex:y?0:void 0,onClick:y?()=>y(r):void 0,onKeyDown:y?M=>M.key==="Enter"&&y(r):void 0,className:`flex flex-col rounded-lg border p-2 transition-all ${g?"cursor-pointer border-blue-500 bg-blue-50 ring-2 ring-blue-400 dark:border-blue-400 dark:bg-blue-900/30 dark:ring-blue-500":h?"cursor-pointer border-gray-200 bg-gray-50 hover:border-gray-300 hover:bg-gray-100 dark:border-gray-600 dark:bg-gray-800/50 dark:hover:border-gray-500 dark:hover:bg-gray-700/50":"cursor-pointer border-gray-200 bg-gray-50 opacity-50 hover:opacity-70 dark:border-gray-600 dark:bg-gray-800/50"}`,children:[e.jsx("img",{src:s.Poster_Link??"",alt:s.Series_Title??"Unknown",className:"aspect-[2/3] w-full rounded object-cover",loading:"lazy"}),e.jsx("p",{className:"mt-1.5 truncate text-xs font-medium text-gray-800 dark:text-gray-200",children:s.Series_Title??"Unknown"}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[s.Released_Year??"?"," · IMDB: ",s.IMDB_Rating??"—"," · Meta: ",s.Meta_score??"—"]})]},r||s.Poster_Link||Math.random())})})]})}function O(){const{rows:o}=D({from:"/assignments/exploratory-vis",select:t=>t.loaderData}),c=i.useMemo(()=>{const t=o.map(a=>Number(a.Released_Year)).filter(a=>!Number.isNaN(a));return[...new Set(t)].sort((a,m)=>a-m)},[o]),[d,w]=i.useState(2e3),[b,y]=i.useState(2020),[p,k]=i.useState(1),[l,s]=i.useState(null),[r,g]=i.useState(null),[h,M]=i.useState("imdb"),{min:n,max:u}=i.useMemo(()=>R(o,d,b),[o,d,b]),N=Math.max(n,Math.min(u,p)),x=i.useMemo(()=>A(o,{yearMin:d,yearMax:b,minConnectionSize:N}),[o,d,b,N]);i.useEffect(()=>{(p<n||p>u)&&k(Math.max(n,Math.min(u,p)))},[n,u,p]);const v=i.useMemo(()=>{const t=new Map;for(const a of o){const m=a.Series_Title??"";m&&t.set(m,a)}return t},[o]),j=i.useMemo(()=>{if(r){const a=v.get(r);return a?[a]:[]}return(l?x.connectionMovies.get([l.actorA,l.actorB].sort().join("|"))??[]:x.allFilteredMovieIds).map(a=>v.get(a)).filter(a=>a!=null)},[r,l,x,v]),S=i.useMemo(()=>{if(r){const t=v.get(r);if(!t)return x;const a=new Set([t.Star1,t.Star2,t.Star3,t.Star4].map(m=>m?.trim()).filter(m=>!!m));return Y(x,a)}return x},[r,x,v]),_=r||(l?`${l.actorA} ↔ ${l.actorB}`:"All movies (filtered)"),C=i.useMemo(()=>x.allFilteredMovieIds.map(t=>v.get(t)).filter(t=>t!=null),[x.allFilteredMovieIds,v]),T=i.useMemo(()=>{const t=j.map(a=>a.Series_Title??"").filter(Boolean);return new Set(t)},[j]),f=r?v.get(r):null;return e.jsxs("section",{className:"rounded-lg border border-gray-200 bg-white p-6 dark:border-gray-700 dark:bg-gray-800/50",children:[e.jsx("h2",{className:"mb-2 text-lg font-semibold text-gray-800 dark:text-gray-200",children:"Which actors appear together, and what movies do they share?"}),e.jsx("p",{className:"mb-2 text-sm text-gray-500 dark:text-gray-400",children:"Based on IMDB's top 1000 movies sorted by rating."}),e.jsx("p",{className:"mb-6 text-sm text-gray-600 dark:text-gray-400",children:`Click a ribbon to filter movies for that actor pair, or click a movie to filter the chord to show only that movie's actors. Only one filter can be active at a time. Use "Clear selection" to reset.`}),e.jsxs("div",{className:"mb-4 flex flex-wrap items-center gap-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"Year:"}),e.jsx("input",{type:"number",value:d,onChange:t=>w(Number(t.target.value)||1920),min:c[0]??1920,max:b,className:"w-16 rounded border border-gray-300 bg-white px-2 py-1 text-gray-900 dark:border-gray-600 dark:bg-gray-700 dark:text-white"}),e.jsx("span",{className:"text-gray-500",children:"–"}),e.jsx("input",{type:"number",value:b,onChange:t=>y(Number(t.target.value)||2024),min:d,max:c[c.length-1]??2024,className:"w-16 rounded border border-gray-300 bg-white px-2 py-1 text-gray-900 dark:border-gray-600 dark:bg-gray-700 dark:text-white"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"Min movies per connection:"}),e.jsx("input",{type:"range",min:n,max:u,value:N,onChange:t=>k(Number(t.target.value)),className:"w-24"}),e.jsx("span",{className:"font-medium text-gray-800 dark:text-gray-200",children:N})]}),(l||r)&&e.jsx("button",{type:"button",onClick:()=>{s(null),g(null)},className:"rounded border border-gray-300 bg-white px-3 py-1 text-sm font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600",children:"Clear selection"})]}),e.jsxs("div",{className:"flex flex-col gap-6 lg:flex-row",children:[e.jsx("div",{className:"shrink-0",children:e.jsx(P,{data:S,onConnectionClick:(t,a)=>{g(null),s(m=>{const B=[t,a].sort().join("|"),I=m?[m.actorA,m.actorB].sort().join("|"):"";return B===I?null:{actorA:t,actorB:a}})},selectedConnection:r?null:l})}),e.jsx("div",{className:"flex max-h-[760px] min-w-0 flex-1 flex-col rounded-lg border border-gray-200 bg-gray-50/50 p-4 dark:border-gray-600 dark:bg-gray-800/30",children:e.jsx(F,{allMovies:C,filteredMovieIds:T,subtitle:_,sortBy:h,onSortChange:M,onMovieClick:t=>{s(null),g(a=>a===t?null:t)},selectedMovieId:r})})]}),f&&e.jsxs("div",{className:"mt-6 rounded-lg border border-gray-200 bg-gray-50 px-4 py-3 dark:border-gray-600 dark:bg-gray-800/30",children:[e.jsxs("h4",{className:"mb-1.5 text-sm font-semibold text-gray-800 dark:text-gray-200",children:[f.Series_Title??"Unknown"," (",f.Released_Year??"?",")"]}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Starring: ",[f.Star1,f.Star2,f.Star3,f.Star4].filter(t=>t?.trim()).join(" · ")]})]}),e.jsxs("div",{className:"mt-8 space-y-4 border-t border-gray-200 pt-6 text-sm text-gray-600 dark:border-gray-600 dark:text-gray-400",children:[e.jsx("p",{children:"Rationale. The visualization asks which actors appear together and what movies they share. The target tasks are to identify actors who have been in top movies together and to get basic info about the movies they did together (mean IMDB, Meta). The two views feed into each other: clicking a movie shows its actors in the chord; clicking a connection then reveals whether those actors have more movies together. Overview first, filter by ribbon or movie, details on demand."}),e.jsx("p",{children:"I chose a chord diagram because it encodes pairwise relationships well. With hundreds of actors the chord becomes unreadable, so I limited it by link size (minimum movies per connection). The chord uses D3's Tableau 10 palette: each actor has one edge colour and each connection has one colour (ribbons blend the two actors at 50%). In a directed diagram colours would signal direction; here the relationship is symmetric so a single colour per connection keeps it simple. I kept the interaction minimal across the two views: mutually exclusive selection (ribbon or movie), reduced opacity for non-filtered movies to preserve context, starring info when a movie is selected. This limits cognitive cost while supporting the tasks."}),e.jsx("p",{children:"Trade-offs. Compared with spring-adjusted network diagrams, chord clusters are less clear, but you can still identify some groupings. Actor pairs below the connection threshold are hidden. An expansion could show which actors have more connections overall, but for this limited dataset (top 1000) that would mostly reflect who appeared most frequently. When setting min movies per connection to 3, most connections involve popular franchises (Harry Potter, LOTR, Avengers). Outliers like The Prestige (2006) and Zodiac (2007) show up because their actors (e.g. Robert Downey Jr, Mark Ruffalo, Michael Caine, Christian Bale) are also part of Batman and Avengers."})]})]})}export{O as component};
