import{x as jt,y as ce,z as ue,A as Mt,B as It,D as Gt,E as fe,h as D,j as R}from"./index-d_4Ofylo.js";function ot(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function he(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Wt(t){let e,r,n;t.length!==2?(e=ot,r=(l,s)=>ot(t(l),s),n=(l,s)=>t(l)-s):(e=t===ot||t===he?t:me,r=t,n=t);function i(l,s,a=0,h=l.length){if(a<h){if(e(s,s)!==0)return h;do{const f=a+h>>>1;r(l[f],s)<0?a=f+1:h=f}while(a<h)}return a}function o(l,s,a=0,h=l.length){if(a<h){if(e(s,s)!==0)return h;do{const f=a+h>>>1;r(l[f],s)<=0?a=f+1:h=f}while(a<h)}return a}function c(l,s,a=0,h=l.length){const f=i(l,s,a,h-1);return f>a&&n(l[f-1],s)>-n(l[f],s)?f-1:f}return{left:i,center:c,right:o}}function me(){return 0}function de(t){return t===null?NaN:+t}const pe=Wt(ot),ge=pe.right,xe=Wt(de).center;function Y(t,e){let r,n;if(e===void 0)for(const i of t)i!=null&&(r===void 0?i>=i&&(r=n=i):(r>i&&(r=i),n<i&&(n=i)));else{let i=-1;for(let o of t)(o=e(o,++i,t))!=null&&(r===void 0?o>=o&&(r=n=o):(r>o&&(r=o),n<o&&(n=o)))}return[r,n]}class Tt extends Map{constructor(e,r=be){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),e!=null)for(const[n,i]of e)this.set(n,i)}get(e){return super.get(Bt(this,e))}has(e){return super.has(Bt(this,e))}set(e,r){return super.set(ye(this,e),r)}delete(e){return super.delete(Me(this,e))}}function Bt({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):r}function ye({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):(t.set(n,r),r)}function Me({_intern:t,_key:e},r){const n=e(r);return t.has(n)&&(r=t.get(n),t.delete(n)),r}function be(t){return t!==null&&typeof t=="object"?t.valueOf():t}const ke=Math.sqrt(50),we=Math.sqrt(10),_e=Math.sqrt(2);function lt(t,e,r){const n=(e-t)/Math.max(0,r),i=Math.floor(Math.log10(n)),o=n/Math.pow(10,i),c=o>=ke?10:o>=we?5:o>=_e?2:1;let l,s,a;return i<0?(a=Math.pow(10,-i)/c,l=Math.round(t*a),s=Math.round(e*a),l/a<t&&++l,s/a>e&&--s,a=-a):(a=Math.pow(10,i)*c,l=Math.round(t/a),s=Math.round(e/a),l*a<t&&++l,s*a>e&&--s),s<l&&.5<=r&&r<2?lt(t,e,r*2):[l,s,a]}function ve(t,e,r){if(e=+e,t=+t,r=+r,!(r>0))return[];if(t===e)return[t];const n=e<t,[i,o,c]=n?lt(e,t,r):lt(t,e,r);if(!(o>=i))return[];const l=o-i+1,s=new Array(l);if(n)if(c<0)for(let a=0;a<l;++a)s[a]=(o-a)/-c;else for(let a=0;a<l;++a)s[a]=(o-a)*c;else if(c<0)for(let a=0;a<l;++a)s[a]=(i+a)/-c;else for(let a=0;a<l;++a)s[a]=(i+a)*c;return s}function bt(t,e,r){return e=+e,t=+t,r=+r,lt(t,e,r)[2]}function Ne(t,e,r){e=+e,t=+t,r=+r;const n=e<t,i=n?bt(e,t,r):bt(t,e,r);return(n?-1:1)*(i<0?1/-i:i)}function $e(t,e){let r;if(e===void 0)for(const n of t)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let i of t)(i=e(i,++n,t))!=null&&(r<i||r===void 0&&i>=i)&&(r=i)}return r}function Ae(t,e){let r;if(e===void 0)for(const n of t)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let i of t)(i=e(i,++n,t))!=null&&(r>i||r===void 0&&i>=i)&&(r=i)}return r}function Re(t,e,r){t=+t,e=+e,r=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+r;for(var n=-1,i=Math.max(0,Math.ceil((e-t)/r))|0,o=new Array(i);++n<i;)o[n]=t+n*r;return o}function Ee(t){return t}var st=1,gt=2,kt=3,et=4,Ct=1e-6;function Se(t){return"translate("+t+",0)"}function je(t){return"translate(0,"+t+")"}function Ie(t){return e=>+t(e)}function Ge(t,e){return e=Math.max(0,t.bandwidth()-e*2)/2,t.round()&&(e=Math.round(e)),r=>+t(r)+e}function Te(){return!this.__axis}function Nt(t,e){var r=[],n=null,i=null,o=6,c=6,l=3,s=typeof window<"u"&&window.devicePixelRatio>1?0:.5,a=t===st||t===et?-1:1,h=t===et||t===gt?"x":"y",f=t===st||t===kt?Se:je;function u(m){var p=n??(e.ticks?e.ticks.apply(e,r):e.domain()),g=i??(e.tickFormat?e.tickFormat.apply(e,r):Ee),x=Math.max(o,0)+l,y=e.range(),v=+y[0]+s,d=+y[y.length-1]+s,w=(e.bandwidth?Ge:Ie)(e.copy(),s),N=m.selection?m.selection():m,_=N.selectAll(".domain").data([null]),A=N.selectAll(".tick").data(p,e).order(),S=A.exit(),b=A.enter().append("g").attr("class","tick"),E=A.select("line"),T=A.select("text");_=_.merge(_.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),A=A.merge(b),E=E.merge(b.append("line").attr("stroke","currentColor").attr(h+"2",a*o)),T=T.merge(b.append("text").attr("fill","currentColor").attr(h,a*x).attr("dy",t===st?"0em":t===kt?"0.71em":"0.32em")),m!==N&&(_=_.transition(m),A=A.transition(m),E=E.transition(m),T=T.transition(m),S=S.transition(m).attr("opacity",Ct).attr("transform",function(M){return isFinite(M=w(M))?f(M+s):this.getAttribute("transform")}),b.attr("opacity",Ct).attr("transform",function(M){var G=this.parentNode.__axis;return f((G&&isFinite(G=G(M))?G:w(M))+s)})),S.remove(),_.attr("d",t===et||t===gt?c?"M"+a*c+","+v+"H"+s+"V"+d+"H"+a*c:"M"+s+","+v+"V"+d:c?"M"+v+","+a*c+"V"+s+"H"+d+"V"+a*c:"M"+v+","+s+"H"+d),A.attr("opacity",1).attr("transform",function(M){return f(w(M)+s)}),E.attr(h+"2",a*o),T.attr(h,a*x).text(g),N.filter(Te).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===gt?"start":t===et?"end":"middle"),N.each(function(){this.__axis=w})}return u.scale=function(m){return arguments.length?(e=m,u):e},u.ticks=function(){return r=Array.from(arguments),u},u.tickArguments=function(m){return arguments.length?(r=m==null?[]:Array.from(m),u):r.slice()},u.tickValues=function(m){return arguments.length?(n=m==null?null:Array.from(m),u):n&&n.slice()},u.tickFormat=function(m){return arguments.length?(i=m,u):i},u.tickSize=function(m){return arguments.length?(o=c=+m,u):o},u.tickSizeInner=function(m){return arguments.length?(o=+m,u):o},u.tickSizeOuter=function(m){return arguments.length?(c=+m,u):c},u.tickPadding=function(m){return arguments.length?(l=+m,u):l},u.offset=function(m){return arguments.length?(s=+m,u):s},u}function Be(t){return Nt(st,t)}function dt(t){return Nt(kt,t)}function rt(t){return Nt(et,t)}function z(t){return typeof t=="string"?new jt([[document.querySelector(t)]],[document.documentElement]):new jt([[t]],ce)}function Ce(t){let e;for(;e=t.sourceEvent;)t=e;return t}function ct(t,e){if(t=Ce(t),e===void 0&&(e=t.currentTarget),e){var r=e.ownerSVGElement||e;if(r.createSVGPoint){var n=r.createSVGPoint();return n.x=t.clientX,n.y=t.clientY,n=n.matrixTransform(e.getScreenCTM().inverse()),[n.x,n.y]}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}}return[t.pageX,t.pageY]}function De(t,e){e||(e=[]);var r=t?Math.min(e.length,t.length):0,n=e.slice(),i;return function(o){for(i=0;i<r;++i)n[i]=t[i]*(1-o)+e[i]*o;return n}}function Pe(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Fe(t,e){var r=e?e.length:0,n=t?Math.min(r,t.length):0,i=new Array(n),o=new Array(r),c;for(c=0;c<n;++c)i[c]=$t(t[c],e[c]);for(;c<r;++c)o[c]=e[c];return function(l){for(c=0;c<n;++c)o[c]=i[c](l);return o}}function ze(t,e){var r=new Date;return t=+t,e=+e,function(n){return r.setTime(t*(1-n)+e*n),r}}function Le(t,e){var r={},n={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?r[i]=$t(t[i],e[i]):n[i]=e[i];return function(o){for(i in r)n[i]=r[i](o);return n}}function $t(t,e){var r=typeof e,n;return e==null||r==="boolean"?ue(e):(r==="number"?Mt:r==="string"?(n=It(e))?(e=n,Gt):fe:e instanceof It?Gt:e instanceof Date?ze:Pe(e)?De:Array.isArray(e)?Fe:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?Le:Mt)(t,e)}function Oe(t,e){return t=+t,e=+e,function(r){return Math.round(t*(1-r)+e*r)}}const wt=Math.PI,_t=2*wt,X=1e-6,Ye=_t-X;function Zt(t){this._+=t[0];for(let e=1,r=t.length;e<r;++e)this._+=arguments[e]+t[e]}function He(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return Zt;const r=10**e;return function(n){this._+=n[0];for(let i=1,o=n.length;i<o;++i)this._+=Math.round(arguments[i]*r)/r+n[i]}}class Ve{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?Zt:He(e)}moveTo(e,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,r){this._append`L${this._x1=+e},${this._y1=+r}`}quadraticCurveTo(e,r,n,i){this._append`Q${+e},${+r},${this._x1=+n},${this._y1=+i}`}bezierCurveTo(e,r,n,i,o,c){this._append`C${+e},${+r},${+n},${+i},${this._x1=+o},${this._y1=+c}`}arcTo(e,r,n,i,o){if(e=+e,r=+r,n=+n,i=+i,o=+o,o<0)throw new Error(`negative radius: ${o}`);let c=this._x1,l=this._y1,s=n-e,a=i-r,h=c-e,f=l-r,u=h*h+f*f;if(this._x1===null)this._append`M${this._x1=e},${this._y1=r}`;else if(u>X)if(!(Math.abs(f*s-a*h)>X)||!o)this._append`L${this._x1=e},${this._y1=r}`;else{let m=n-c,p=i-l,g=s*s+a*a,x=m*m+p*p,y=Math.sqrt(g),v=Math.sqrt(u),d=o*Math.tan((wt-Math.acos((g+u-x)/(2*y*v)))/2),w=d/v,N=d/y;Math.abs(w-1)>X&&this._append`L${e+w*h},${r+w*f}`,this._append`A${o},${o},0,0,${+(f*m>h*p)},${this._x1=e+N*s},${this._y1=r+N*a}`}}arc(e,r,n,i,o,c){if(e=+e,r=+r,n=+n,c=!!c,n<0)throw new Error(`negative radius: ${n}`);let l=n*Math.cos(i),s=n*Math.sin(i),a=e+l,h=r+s,f=1^c,u=c?i-o:o-i;this._x1===null?this._append`M${a},${h}`:(Math.abs(this._x1-a)>X||Math.abs(this._y1-h)>X)&&this._append`L${a},${h}`,n&&(u<0&&(u=u%_t+_t),u>Ye?this._append`A${n},${n},0,1,${f},${e-l},${r-s}A${n},${n},0,1,${f},${this._x1=a},${this._y1=h}`:u>X&&this._append`A${n},${n},0,${+(u>=wt)},${f},${this._x1=e+n*Math.cos(o)},${this._y1=r+n*Math.sin(o)}`)}rect(e,r,n,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}h${n=+n}v${+i}h${-n}Z`}toString(){return this._}}function Xe(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function ut(t,e){if(!isFinite(t)||t===0)return null;var r=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"),n=t.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+t.slice(r+1)]}function Z(t){return t=ut(Math.abs(t)),t?t[1]:NaN}function qe(t,e){return function(r,n){for(var i=r.length,o=[],c=0,l=t[0],s=0;i>0&&l>0&&(s+l+1>n&&(l=Math.max(1,n-s)),o.push(r.substring(i-=l,i+l)),!((s+=l+1)>n));)l=t[c=(c+1)%t.length];return o.reverse().join(e)}}function Ue(t){return function(e){return e.replace(/[0-9]/g,function(r){return t[+r]})}}var We=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ft(t){if(!(e=We.exec(t)))throw new Error("invalid format: "+t);var e;return new At({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}ft.prototype=At.prototype;function At(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}At.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Ze(t){t:for(var e=t.length,r=1,n=-1,i;r<e;++r)switch(t[r]){case".":n=i=r;break;case"0":n===0&&(n=r),i=r;break;default:if(!+t[r])break t;n>0&&(n=0);break}return n>0?t.slice(0,n)+t.slice(i+1):t}var ht;function Qe(t,e){var r=ut(t,e);if(!r)return ht=void 0,t.toPrecision(e);var n=r[0],i=r[1],o=i-(ht=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,c=n.length;return o===c?n:o>c?n+new Array(o-c+1).join("0"):o>0?n.slice(0,o)+"."+n.slice(o):"0."+new Array(1-o).join("0")+ut(t,Math.max(0,e+o-1))[0]}function Dt(t,e){var r=ut(t,e);if(!r)return t+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}const Pt={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:Xe,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Dt(t*100,e),r:Dt,s:Qe,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Ft(t){return t}var zt=Array.prototype.map,Lt=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Je(t){var e=t.grouping===void 0||t.thousands===void 0?Ft:qe(zt.call(t.grouping,Number),t.thousands+""),r=t.currency===void 0?"":t.currency[0]+"",n=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",o=t.numerals===void 0?Ft:Ue(zt.call(t.numerals,String)),c=t.percent===void 0?"%":t.percent+"",l=t.minus===void 0?"−":t.minus+"",s=t.nan===void 0?"NaN":t.nan+"";function a(f,u){f=ft(f);var m=f.fill,p=f.align,g=f.sign,x=f.symbol,y=f.zero,v=f.width,d=f.comma,w=f.precision,N=f.trim,_=f.type;_==="n"?(d=!0,_="g"):Pt[_]||(w===void 0&&(w=12),N=!0,_="g"),(y||m==="0"&&p==="=")&&(y=!0,m="0",p="=");var A=(u&&u.prefix!==void 0?u.prefix:"")+(x==="$"?r:x==="#"&&/[boxX]/.test(_)?"0"+_.toLowerCase():""),S=(x==="$"?n:/[%p]/.test(_)?c:"")+(u&&u.suffix!==void 0?u.suffix:""),b=Pt[_],E=/[defgprs%]/.test(_);w=w===void 0?6:/[gprs]/.test(_)?Math.max(1,Math.min(21,w)):Math.max(0,Math.min(20,w));function T(M){var G=A,C=S,P,at,H;if(_==="c")C=b(M)+C,M="";else{M=+M;var q=M<0||1/M<0;if(M=isNaN(M)?s:b(Math.abs(M),w),N&&(M=Ze(M)),q&&+M==0&&g!=="+"&&(q=!1),G=(q?g==="("?g:l:g==="-"||g==="("?"":g)+G,C=(_==="s"&&!isNaN(M)&&ht!==void 0?Lt[8+ht/3]:"")+C+(q&&g==="("?")":""),E){for(P=-1,at=M.length;++P<at;)if(H=M.charCodeAt(P),48>H||H>57){C=(H===46?i+M.slice(P+1):M.slice(P))+C,M=M.slice(0,P);break}}}d&&!y&&(M=e(M,1/0));var V=G.length+M.length+C.length,L=V<v?new Array(v-V+1).join(m):"";switch(d&&y&&(M=e(L+M,L.length?v-C.length:1/0),L=""),p){case"<":M=G+M+C+L;break;case"=":M=G+L+M+C;break;case"^":M=L.slice(0,V=L.length>>1)+G+M+C+L.slice(V);break;default:M=L+G+M+C;break}return o(M)}return T.toString=function(){return f+""},T}function h(f,u){var m=Math.max(-8,Math.min(8,Math.floor(Z(u)/3)))*3,p=Math.pow(10,-m),g=a((f=ft(f),f.type="f",f),{suffix:Lt[8+m/3]});return function(x){return g(p*x)}}return{format:a,formatPrefix:h}}var it,Qt,Jt;Ke({thousands:",",grouping:[3],currency:["$",""]});function Ke(t){return it=Je(t),Qt=it.format,Jt=it.formatPrefix,it}function tn(t){return Math.max(0,-Z(Math.abs(t)))}function en(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Z(e)/3)))*3-Z(Math.abs(t)))}function nn(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Z(e)-Z(t))+1}function Rt(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}const Ot=Symbol("implicit");function pt(){var t=new Tt,e=[],r=[],n=Ot;function i(o){let c=t.get(o);if(c===void 0){if(n!==Ot)return n;t.set(o,c=e.push(o)-1)}return r[c%r.length]}return i.domain=function(o){if(!arguments.length)return e.slice();e=[],t=new Tt;for(const c of o)t.has(c)||t.set(c,e.push(c)-1);return i},i.range=function(o){return arguments.length?(r=Array.from(o),i):r.slice()},i.unknown=function(o){return arguments.length?(n=o,i):n},i.copy=function(){return pt(e,r).unknown(n)},Rt.apply(i,arguments),i}function Kt(){var t=pt().unknown(void 0),e=t.domain,r=t.range,n=0,i=1,o,c,l=!1,s=0,a=0,h=.5;delete t.unknown;function f(){var u=e().length,m=i<n,p=m?i:n,g=m?n:i;o=(g-p)/Math.max(1,u-s+a*2),l&&(o=Math.floor(o)),p+=(g-p-o*(u-s))*h,c=o*(1-s),l&&(p=Math.round(p),c=Math.round(c));var x=Re(u).map(function(y){return p+o*y});return r(m?x.reverse():x)}return t.domain=function(u){return arguments.length?(e(u),f()):e()},t.range=function(u){return arguments.length?([n,i]=u,n=+n,i=+i,f()):[n,i]},t.rangeRound=function(u){return[n,i]=u,n=+n,i=+i,l=!0,f()},t.bandwidth=function(){return c},t.step=function(){return o},t.round=function(u){return arguments.length?(l=!!u,f()):l},t.padding=function(u){return arguments.length?(s=Math.min(1,a=+u),f()):s},t.paddingInner=function(u){return arguments.length?(s=Math.min(1,u),f()):s},t.paddingOuter=function(u){return arguments.length?(a=+u,f()):a},t.align=function(u){return arguments.length?(h=Math.max(0,Math.min(1,u)),f()):h},t.copy=function(){return Kt(e(),[n,i]).round(l).paddingInner(s).paddingOuter(a).align(h)},Rt.apply(f(),arguments)}function rn(t){return function(){return t}}function an(t){return+t}var Yt=[0,1];function W(t){return t}function vt(t,e){return(e-=t=+t)?function(r){return(r-t)/e}:rn(isNaN(e)?NaN:.5)}function on(t,e){var r;return t>e&&(r=t,t=e,e=r),function(n){return Math.max(t,Math.min(e,n))}}function sn(t,e,r){var n=t[0],i=t[1],o=e[0],c=e[1];return i<n?(n=vt(i,n),o=r(c,o)):(n=vt(n,i),o=r(o,c)),function(l){return o(n(l))}}function ln(t,e,r){var n=Math.min(t.length,e.length)-1,i=new Array(n),o=new Array(n),c=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++c<n;)i[c]=vt(t[c],t[c+1]),o[c]=r(e[c],e[c+1]);return function(l){var s=ge(t,l,1,n)-1;return o[s](i[s](l))}}function cn(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function un(){var t=Yt,e=Yt,r=$t,n,i,o,c=W,l,s,a;function h(){var u=Math.min(t.length,e.length);return c!==W&&(c=on(t[0],t[u-1])),l=u>2?ln:sn,s=a=null,f}function f(u){return u==null||isNaN(u=+u)?o:(s||(s=l(t.map(n),e,r)))(n(c(u)))}return f.invert=function(u){return c(i((a||(a=l(e,t.map(n),Mt)))(u)))},f.domain=function(u){return arguments.length?(t=Array.from(u,an),h()):t.slice()},f.range=function(u){return arguments.length?(e=Array.from(u),h()):e.slice()},f.rangeRound=function(u){return e=Array.from(u),r=Oe,h()},f.clamp=function(u){return arguments.length?(c=u?!0:W,h()):c!==W},f.interpolate=function(u){return arguments.length?(r=u,h()):r},f.unknown=function(u){return arguments.length?(o=u,f):o},function(u,m){return n=u,i=m,h()}}function fn(){return un()(W,W)}function hn(t,e,r,n){var i=Ne(t,e,r),o;switch(n=ft(n??",f"),n.type){case"s":{var c=Math.max(Math.abs(t),Math.abs(e));return n.precision==null&&!isNaN(o=en(i,c))&&(n.precision=o),Jt(n,c)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(o=nn(i,Math.max(Math.abs(t),Math.abs(e))))&&(n.precision=o-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(o=tn(i))&&(n.precision=o-(n.type==="%")*2);break}}return Qt(n)}function mn(t){var e=t.domain;return t.ticks=function(r){var n=e();return ve(n[0],n[n.length-1],r??10)},t.tickFormat=function(r,n){var i=e();return hn(i[0],i[i.length-1],r??10,n)},t.nice=function(r){r==null&&(r=10);var n=e(),i=0,o=n.length-1,c=n[i],l=n[o],s,a,h=10;for(l<c&&(a=c,c=l,l=a,a=i,i=o,o=a);h-- >0;){if(a=bt(c,l,r),a===s)return n[i]=c,n[o]=l,e(n);if(a>0)c=Math.floor(c/a)*a,l=Math.ceil(l/a)*a;else if(a<0)c=Math.ceil(c*a)/a,l=Math.floor(l*a)/a;else break;s=a}return t},t}function O(){var t=fn();return t.copy=function(){return cn(t,O())},Rt.apply(t,arguments),mn(t)}function I(t){return function(){return t}}function te(t){let e=3;return t.digits=function(r){if(!arguments.length)return e;if(r==null)e=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);e=n}return t},()=>new Ve(e)}function ee(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function ne(t){this._context=t}ne.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function re(t){return new ne(t)}function ae(t){return t[0]}function ie(t){return t[1]}function nt(t,e){var r=I(!0),n=null,i=re,o=null,c=te(l);t=typeof t=="function"?t:t===void 0?ae:I(t),e=typeof e=="function"?e:e===void 0?ie:I(e);function l(s){var a,h=(s=ee(s)).length,f,u=!1,m;for(n==null&&(o=i(m=c())),a=0;a<=h;++a)!(a<h&&r(f=s[a],a,s))===u&&((u=!u)?o.lineStart():o.lineEnd()),u&&o.point(+t(f,a,s),+e(f,a,s));if(m)return o=null,m+""||null}return l.x=function(s){return arguments.length?(t=typeof s=="function"?s:I(+s),l):t},l.y=function(s){return arguments.length?(e=typeof s=="function"?s:I(+s),l):e},l.defined=function(s){return arguments.length?(r=typeof s=="function"?s:I(!!s),l):r},l.curve=function(s){return arguments.length?(i=s,n!=null&&(o=i(n)),l):i},l.context=function(s){return arguments.length?(s==null?n=o=null:o=i(n=s),l):n},l}function Ht(t,e,r){var n=null,i=I(!0),o=null,c=re,l=null,s=te(a);t=typeof t=="function"?t:t===void 0?ae:I(+t),e=typeof e=="function"?e:I(e===void 0?0:+e),r=typeof r=="function"?r:r===void 0?ie:I(+r);function a(f){var u,m,p,g=(f=ee(f)).length,x,y=!1,v,d=new Array(g),w=new Array(g);for(o==null&&(l=c(v=s())),u=0;u<=g;++u){if(!(u<g&&i(x=f[u],u,f))===y)if(y=!y)m=u,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),p=u-1;p>=m;--p)l.point(d[p],w[p]);l.lineEnd(),l.areaEnd()}y&&(d[u]=+t(x,u,f),w[u]=+e(x,u,f),l.point(n?+n(x,u,f):d[u],r?+r(x,u,f):w[u]))}if(v)return l=null,v+""||null}function h(){return nt().defined(i).curve(c).context(o)}return a.x=function(f){return arguments.length?(t=typeof f=="function"?f:I(+f),n=null,a):t},a.x0=function(f){return arguments.length?(t=typeof f=="function"?f:I(+f),a):t},a.x1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:I(+f),a):n},a.y=function(f){return arguments.length?(e=typeof f=="function"?f:I(+f),r=null,a):e},a.y0=function(f){return arguments.length?(e=typeof f=="function"?f:I(+f),a):e},a.y1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:I(+f),a):r},a.lineX0=a.lineY0=function(){return h().x(t).y(e)},a.lineY1=function(){return h().x(t).y(r)},a.lineX1=function(){return h().x(n).y(e)},a.defined=function(f){return arguments.length?(i=typeof f=="function"?f:I(!!f),a):i},a.curve=function(f){return arguments.length?(c=f,o!=null&&(l=c(o)),a):c},a.context=function(f){return arguments.length?(f==null?o=l=null:l=c(o=f),a):o},a}function oe(t,e){this._context=t,this._t=e}oe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var r=this._x*(1-this._t)+t*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,e)}break}}this._x=t,this._y=e}};function J(t){return new oe(t,.5)}function se(t){if(!t)return null;const e=t.trim().match(/^(\d+)\s*min/i);return e?Number(e[1]):null}function An(t,e,r){const n=r==="imdb"?"IMDB_Rating":"Meta_score",i=[],o=new Map;for(const l of t){const s=Number(l.Released_Year),a=Number(l[n]);Number.isNaN(s)||Number.isNaN(a)||(o.has(s)||o.set(s,[]),o.get(s).push(a))}const c=[...o.entries()].sort((l,s)=>l[0]-s[0]).map(([l,s])=>({year:l,value:s.reduce((a,h)=>a+h,0)/s.length}));i.push({key:"All",values:c});for(const l of e){const s=new Map;for(const h of t){if(h[l]!=="true")continue;const f=Number(h.Released_Year),u=Number(h[n]);Number.isNaN(f)||Number.isNaN(u)||(s.has(f)||s.set(f,[]),s.get(f).push(u))}const a=[...s.entries()].sort((h,f)=>h[0]-f[0]).map(([h,f])=>({year:h,value:f.reduce((u,m)=>u+m,0)/f.length}));a.length>0&&i.push({key:l,values:a})}return i}function Rn(t,e="imdb"){const r=e==="imdb"?"IMDB_Rating":"Meta_score",n=[];for(const i of t){const o=se(i.Runtime??""),c=Number(i[r]),l=Number(i.Released_Year),a=(i.Genre??"").split(",")[0]?.trim()??"Other";o==null||Number.isNaN(c)||Number.isNaN(l)||n.push({runtime:o,rating:c,genre:a,year:l})}return n}function En(t,e="imdb"){const r=e==="imdb"?"IMDB_Rating":"Meta_score",n=new Map;for(const i of t){const o=se(i.Runtime??""),c=Number(i[r]),s=(i.Genre??"").split(",")[0]?.trim()??"Other";o==null||Number.isNaN(c)||(n.has(s)||n.set(s,{runtime:[],rating:[]}),n.get(s).runtime.push(o),n.get(s).rating.push(c))}return[...n.entries()].map(([i,{runtime:o,rating:c}])=>({genre:i,runtime:o.reduce((l,s)=>l+s,0)/o.length,rating:c.reduce((l,s)=>l+s,0)/c.length,count:o.length})).sort((i,o)=>i.genre.localeCompare(o.genre))}function Vt(t){if(t==="All")return"All";const e=t.startsWith("is")?t.slice(2):t;return e.charAt(0).toUpperCase()+e.slice(1)}function Sn(t){const e=[];for(const r of t){const n=Number(r.Meta_score?.trim()),i=Number(r.IMDB_Rating?.trim()),c=(r.Genre??"").split(",")[0]?.trim()??"Other",l=r.Series_Title??"Unknown";Number.isNaN(n)||Number.isNaN(i)||e.push({meta:n,imdb:i,genre:c,title:l})}return e}const le=t=>(t-1)/9*100;function jn(t){const e=new Map;for(const r of t){const n=Number(r.Meta_score?.trim()),i=Number(r.IMDB_Rating?.trim()),o=Number(r.Released_Year);if(Number.isNaN(n)||Number.isNaN(i)||Number.isNaN(o))continue;const c=le(i),l=c-n;e.has(o)||e.set(o,{metas:[],imdbRescaled:[],gaps:[]});const s=e.get(o);s.metas.push(n),s.imdbRescaled.push(c),s.gaps.push(l)}return[...e.entries()].sort((r,n)=>r[0]-n[0]).map(([r,{metas:n,imdbRescaled:i,gaps:o}])=>{const c=n.reduce((s,a)=>s+a,0)/n.length,l=i.reduce((s,a)=>s+a,0)/i.length;return{year:r,meanGap:o.reduce((s,a)=>s+a,0)/o.length,meanMeta:c,meanImdbRescaled:l,meanAvg:(c+l)/2,count:o.length}})}function In(t){const e=new Map;for(const r of t){const n=Number(r.Meta_score?.trim()),i=Number(r.IMDB_Rating?.trim()),c=(r.Genre??"").split(",")[0]?.trim()??"Other";if(Number.isNaN(n)||Number.isNaN(i))continue;const l=le(i)-n;e.has(c)||e.set(c,[]),e.get(c).push(l)}return[...e.entries()].map(([r,n])=>({genre:r,meanGap:n.reduce((i,o)=>i+o,0)/n.length,count:n.length})).sort((r,n)=>r.meanGap-n.meanGap)}function dn(t,e){const r=Math.min(t.length,e.length);if(r<2)return 0;const n=t.reduce((a,h)=>a+h,0)/r,i=e.reduce((a,h)=>a+h,0)/r;let o=0,c=0,l=0;for(let a=0;a<r;a++){const h=t[a]-n,f=e[a]-i;o+=h*f,c+=h*h,l+=f*f}const s=Math.sqrt(c*l);return s<1e-10?0:o/s}function pn(t,e){const r=Math.min(t.length,e.length);if(r<2)return{slope:0,intercept:0};const n=t.reduce((a,h)=>a+h,0)/r,i=e.reduce((a,h)=>a+h,0)/r;let o=0,c=0;for(let a=0;a<r;a++){const h=t[a]-n;o+=h*(e[a]-i),c+=h*h}const l=c<1e-10?0:o/c,s=i-l*n;return{slope:l,intercept:s}}const $=928,U=500,K=600,k={top:25,right:30,bottom:35,left:45},mt=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"];function Xt(t,e){return t==="All"?"#333":mt[e%mt.length]}function Gn({series:t,visibleKeys:e,metric:r,domain:n}){const i=D.useRef(null),o=D.useRef(null);D.useEffect(()=>{if(!o.current||!i.current||t.length===0)return;const l=t.filter(b=>e.has(b.key));if(l.length===0)return;const s=l.flatMap(b=>b.values.map(E=>E.year)),a=l.flatMap(b=>b.values.map(E=>E.value)),h=Math.min(...s),f=Math.max(...s),u=Math.min(...a),m=Math.max(...a),p=n&&!Number.isNaN(n.xMin)?n.xMin:h,g=n&&!Number.isNaN(n.xMax)?n.xMax:f,x=n&&!Number.isNaN(n.yMin)?n.yMin:u,y=n&&!Number.isNaN(n.yMax)?n.yMax:m,v=O().domain([p,g]).range([k.left,$-k.right]),d=O().domain([x,y]).range([U-k.bottom,k.top]),w=nt().x(b=>v(b.year)).y(b=>d(b.value));z(o.current).selectAll("*").remove();const N=z(o.current).attr("viewBox",[0,0,$,U]).attr("style","max-width: 100%; height: auto; font: 10px sans-serif;").style("overflow","visible").style("-webkit-tap-highlight-color","transparent");N.append("g").attr("transform",`translate(0,${U-k.bottom})`).call(dt(v).ticks(Math.min(20,g-p+1)).tickSizeOuter(0)),N.append("g").attr("transform",`translate(${k.left},0)`).call(rt(d).ticks(U/50)).call(b=>b.select(".domain").remove()).call(b=>b.selectAll(".tick line").clone().attr("x2",$-k.left-k.right).attr("stroke-opacity",.1)).call(b=>b.append("text").attr("x",-45).attr("y",10).attr("fill","currentColor").attr("text-anchor","start").text(`↑ Avg ${r==="imdb"?"IMDB Rating":"Meta score"}`)),l.forEach((b,E)=>{const T=Xt(b.key,E);N.append("path").attr("fill","none").attr("stroke",T).attr("stroke-width",b.key==="All"?2.5:1.5).attr("d",w(b.values)??"")});const _=N.append("g").attr("pointer-events","none").style("display","none");function A(b){const E=ct(b)[0],T=v.invert(E);_.style("display",null);const M=l.flatMap(j=>j.values.map(F=>F.year)),G=[...new Set(M)].sort((j,F)=>j-F),C=xe(G,T),P=G[Math.max(0,Math.min(C,G.length-1))]??G[0],at=v(P),H=l.find(j=>j.values.some(F=>F.year===P)),q=H?d(H.values.find(j=>j.year===P).value):U/2;_.attr("transform",`translate(${at},${q})`);const V=[`Year: ${P}`];l.forEach(j=>{const F=j.values.find(Q=>Q.year===P);F&&V.push(`${Vt(j.key)}: ${F.value.toFixed(2)}`)});const L=_.selectAll("path").data([1]).join("path").attr("fill","white").attr("stroke","black").attr("stroke-width",1),Et=_.selectAll("text").data([1]).join("text").call(j=>j.selectAll("tspan").data(V).join("tspan").attr("x",0).attr("y",(F,Q)=>`${Q*1.1}em`).attr("font-weight",(F,Q)=>Q===0?"bold":null).text(F=>F)),St=Et.node();if(St){const j=St.getBBox();Et.attr("transform",`translate(${-j.width/2},${15-j.y})`),L.attr("d",`M${-j.width/2-10},5H-5l5,-5l5,5H${j.width/2+10}v${j.height+20}h-${j.width+20}z`)}}function S(){_.style("display","none")}return N.on("pointerenter pointermove",A).on("pointerleave",S),()=>{N.on("pointerenter pointermove",null).on("pointerleave",null)}},[t,e,r,n]);const c=t.filter(l=>e.has(l.key));return R.jsxs("div",{ref:i,className:"flex flex-col gap-2",children:[R.jsx("svg",{ref:o,width:$,height:U,className:"overflow-visible"}),R.jsx("div",{className:"flex flex-wrap gap-4 text-xs",children:c.map((l,s)=>R.jsxs("span",{className:"flex items-center gap-1.5",children:[R.jsx("span",{className:"inline-block h-0.5 w-4 rounded",style:{backgroundColor:Xt(l.key,s),height:l.key==="All"?3:2}}),R.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:Vt(l.key)})]},l.key))})]})}function Tn({points:t,pointsByGenre:e,selectedYear:r,showAllMovies:n=!1,metric:i="imdb"}){const o=D.useRef(null),c=r!=null&&!n,l=n?t:c?t.filter(u=>u.year===r):e.map(u=>({...u,year:0})),s=[...new Set(l.map(u=>u.genre))].sort(),a=pt().domain(s).range(mt),h=n||c?Y(t,u=>u.runtime):Y(e,u=>u.runtime),f=n||c?Y(t,u=>u.rating):Y(e,u=>u.rating);return D.useEffect(()=>{if(!o.current)return;const u=O().domain(h).nice().range([k.left,$-k.right]),m=O().domain(f).nice().range([K-k.bottom,k.top]);z(o.current).selectAll("*").remove();const p=z(o.current).attr("viewBox",[0,0,$,K]).attr("style","max-width: 100%; height: auto; font: 10px sans-serif;").style("overflow","visible");p.append("g").attr("transform",`translate(0,${K-k.bottom})`).call(dt(u).ticks($/80)).call(x=>x.select(".domain").remove()).call(x=>x.append("text").attr("x",$).attr("y",k.bottom-4).attr("fill","currentColor").attr("text-anchor","end").text("Runtime (min) →")),p.append("g").attr("transform",`translate(${k.left},0)`).call(rt(m)).call(x=>x.select(".domain").remove()).call(x=>x.append("text").attr("x",-45).attr("y",10).attr("fill","currentColor").attr("text-anchor","start").text(i==="imdb"?"↑ IMDB Rating":"↑ Meta score")),p.append("g").attr("stroke","currentColor").attr("stroke-opacity",.1).call(x=>x.append("g").selectAll("line").data(u.ticks()).join("line").attr("x1",y=>.5+u(y)).attr("x2",y=>.5+u(y)).attr("y1",k.top).attr("y2",K-k.bottom)).call(x=>x.append("g").selectAll("line").data(m.ticks()).join("line").attr("y1",y=>.5+m(y)).attr("y2",y=>.5+m(y)).attr("x1",k.left).attr("x2",$-k.right));const g=p.append("g").attr("pointer-events","none").style("display","none");p.append("g").selectAll("circle").data(l.length>0?l:[]).join("circle").attr("cx",x=>u(x.runtime)).attr("cy",x=>m(x.rating)).attr("r",c||n?3.5:6).attr("fill",x=>a(x.genre)).attr("stroke","#333").attr("stroke-width",.5).style("cursor","pointer").on("pointerenter pointermove",function(x,y){g.style("display",null);const[v,d]=ct(x);g.attr("transform",`translate(${v+12},${d+12})`);const w=i==="imdb"?"IMDB":"Meta",N=c||n?[...c?[`Year: ${y.year}`]:[],`Runtime: ${y.runtime.toFixed(0)} min`,`${w}: ${y.rating.toFixed(1)}`,`Genre: ${y.genre}`]:[`Genre: ${y.genre}`,`Avg runtime: ${y.runtime.toFixed(0)} min`,`Avg ${w.toLowerCase()} rating: ${y.rating.toFixed(2)}`,`Movies: ${"count"in y?y.count:""}`],_=g.selectAll("path").data([1]).join("path").attr("fill","white").attr("stroke","black").attr("stroke-width",1),A=g.selectAll("text").data([1]).join("text").call(b=>b.selectAll("tspan").data(N).join("tspan").attr("x",0).attr("y",(E,T)=>`${T*1.1}em`).attr("font-weight",(E,T)=>T===0?"bold":null).text(E=>E)),S=A.node();if(S&&S.getBBox){const b=S.getBBox();A.attr("transform",`translate(0,${-b.y})`),_.attr("d",`M0,0h${b.width+16}v${b.height+12}h-${b.width+16}z`)}}).on("pointerleave",()=>{g.style("display","none")})},[l,r,h,f,c,n,i]),R.jsxs("div",{className:"flex flex-col gap-2",children:[R.jsx("svg",{ref:o,width:$,height:K,className:"overflow-visible"}),R.jsx("div",{className:"flex flex-wrap gap-4 text-xs",children:s.map(u=>R.jsxs("span",{className:"flex items-center gap-1.5",children:[R.jsx("span",{className:"inline-block h-3 w-3 rounded-full border border-gray-700",style:{backgroundColor:a(u)}}),R.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:u})]},u))})]})}const tt=560;function Bn({points:t}){const e=D.useRef(null),r=D.useMemo(()=>[...new Set(t.map(s=>s.genre))].sort(),[t]),n=pt().domain(r).range(mt),i=D.useMemo(()=>dn(t.map(s=>s.meta),t.map(s=>s.imdb)),[t]),o=D.useMemo(()=>{const s=new Map;for(const a of r){const h=t.filter(f=>f.genre===a);if(h.length>=2){const f=h.map(m=>m.meta),u=h.map(m=>m.imdb);s.set(a,pn(f,u))}}return s},[t,r]),c=Y(t,s=>s.meta),l=Y(t,s=>s.imdb);return D.useEffect(()=>{if(!e.current||t.length===0)return;const s=O().domain(c).nice().range([k.left,$-k.right]),a=O().domain(l).nice().range([tt-k.bottom,k.top]);z(e.current).selectAll("*").remove();const h=z(e.current).attr("viewBox",[0,0,$,tt]).attr("style","max-width: 100%; height: auto; font: 10px sans-serif;").style("overflow","visible");h.append("g").attr("transform",`translate(0,${tt-k.bottom})`).call(dt(s).ticks($/80)).call(p=>p.select(".domain").remove()).call(p=>p.append("text").attr("x",$).attr("y",k.bottom-4).attr("fill","currentColor").attr("text-anchor","end").text("Meta score (critics) →")),h.append("g").attr("transform",`translate(${k.left},0)`).call(rt(a)).call(p=>p.select(".domain").remove()).call(p=>p.append("text").attr("x",-45).attr("y",10).attr("fill","currentColor").attr("text-anchor","start").text("↑ IMDB Rating (audiences)")),h.append("g").attr("stroke","currentColor").attr("stroke-opacity",.1).call(p=>p.append("g").selectAll("line").data(s.ticks()).join("line").attr("x1",g=>.5+s(g)).attr("x2",g=>.5+s(g)).attr("y1",k.top).attr("y2",tt-k.bottom)).call(p=>p.append("g").selectAll("line").data(a.ticks()).join("line").attr("y1",g=>.5+a(g)).attr("y2",g=>.5+a(g)).attr("x1",k.left).attr("x2",$-k.right));const f=h.append("g").attr("pointer-events","none").style("display","none"),u=s.domain()[0]??0,m=s.domain()[1]??100;o.forEach((p,g)=>{const x=p.slope*u+p.intercept,y=p.slope*m+p.intercept,v=h.append("g").attr("class","trend-line-group").style("cursor","pointer");v.append("line").attr("x1",s(u)).attr("x2",s(m)).attr("y1",a(x)).attr("y2",a(y)).attr("stroke","transparent").attr("stroke-width",16),v.append("line").attr("x1",s(u)).attr("x2",s(m)).attr("y1",a(x)).attr("y2",a(y)).attr("stroke",n(g)).attr("stroke-width",2).attr("stroke-dasharray","4,4").attr("opacity",.85),v.append("title").text(`${g} trend line`),v.on("pointerenter pointermove",function(d){f.style("display",null);const[w,N]=ct(d);f.attr("transform",`translate(${w+12},${N+12})`);const _=f.selectAll("path").data([1]).join("path").attr("fill","white").attr("stroke","black").attr("stroke-width",1),A=f.selectAll("text").data([1]).join("text").call(b=>b.selectAll("tspan").data([`${g} (trend line)`]).join("tspan").attr("x",0).attr("y",0).attr("font-weight","bold").text(E=>E)),S=A.node();if(S&&S.getBBox){const b=S.getBBox();A.attr("transform",`translate(0,${-b.y})`),_.attr("d",`M0,0h${b.width+16}v${b.height+12}h-${b.width+16}z`)}}),v.on("pointerleave",()=>f.style("display","none"))}),h.append("g").selectAll("circle").data(t).join("circle").attr("cx",p=>s(p.meta)).attr("cy",p=>a(p.imdb)).attr("r",3.5).attr("fill",p=>n(p.genre)).attr("stroke","#333").attr("stroke-width",.5).style("cursor","pointer").on("pointerenter pointermove",function(p,g){f.style("display",null);const[x,y]=ct(p);f.attr("transform",`translate(${x+12},${y+12})`);const v=[g.title,`Meta: ${g.meta.toFixed(0)}`,`IMDB: ${g.imdb.toFixed(1)}`,g.genre],d=f.selectAll("path").data([1]).join("path").attr("fill","white").attr("stroke","black").attr("stroke-width",1),w=f.selectAll("text").data([1]).join("text").call(_=>_.selectAll("tspan").data(v).join("tspan").attr("x",0).attr("y",(A,S)=>`${S*1.1}em`).attr("font-weight",(A,S)=>S===0?"bold":null).text(A=>A)),N=w.node();if(N&&N.getBBox){const _=N.getBBox();w.attr("transform",`translate(0,${-_.y})`),d.attr("d",`M0,0h${_.width+16}v${_.height+12}h-${_.width+16}z`)}}).on("pointerleave",()=>{f.style("display","none")})},[t,c,l,r,o]),R.jsxs("div",{className:"flex flex-col gap-2",children:[R.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:["Pearson r = ",i.toFixed(3),". Dashed lines = linear trend per genre (IMDB on Meta); colors match legend. Points above a genre’s line = audiences rate higher than critics for that genre; below = critics rate higher."]}),R.jsx("svg",{ref:e,width:$,height:tt,className:"overflow-visible"}),R.jsx("div",{className:"flex flex-wrap gap-4 text-xs",children:r.map(s=>R.jsxs("span",{className:"flex items-center gap-1.5",children:[R.jsx("span",{className:"inline-block h-3 w-3 rounded-full border border-gray-700",style:{backgroundColor:n(s)}}),R.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:s})]},s))})]})}const qt=420,gn=22,B={top:24,right:50,bottom:16,left:90},xt="#e6550d",yt="#3182bd";function Cn({data:t}){const e=D.useRef(null),r=Y(t,o=>o.year),n=[Math.min(Ae(t,o=>Math.min(o.meanMeta,o.meanImdbRescaled))??0,0),Math.max($e(t,o=>Math.max(o.meanMeta,o.meanImdbRescaled))??100,100)],i=qt;return D.useEffect(()=>{if(!e.current||t.length===0)return;const o=O().domain(r).range([k.left,$-k.right]),c=O().domain(n).range([i-k.bottom,k.top]);z(e.current).selectAll("*").remove();const l=z(e.current).attr("viewBox",[0,0,$,i]).attr("style","max-width: 100%; height: auto; font: 10px sans-serif;").style("overflow","visible");l.append("g").attr("transform",`translate(0,${i-k.bottom})`).call(dt(o).ticks($/80).tickSizeOuter(0)).call(a=>a.select(".domain").remove()),l.append("g").attr("transform",`translate(${k.left},0)`).call(rt(c)).call(a=>a.select(".domain").remove()).call(a=>a.selectAll(".tick line").clone().attr("x2",$-k.left-k.right).attr("stroke-opacity",.1)).call(a=>a.select(".tick:last-of-type text").clone().attr("x",-45).attr("y",-24).attr("fill","currentColor").attr("text-anchor","start").text("↑ Score (0–100)")),l.append("path").attr("fill",xt).attr("fill-opacity",.4).attr("d",Ht().curve(J).x(a=>o(a.year)).y0(a=>c(a.meanAvg)).y1(a=>c(a.meanImdbRescaled))(t)),l.append("path").attr("fill",yt).attr("fill-opacity",.4).attr("d",Ht().curve(J).x(a=>o(a.year)).y0(a=>c(a.meanAvg)).y1(a=>c(a.meanMeta))(t)),l.append("path").attr("fill","none").attr("stroke","black").attr("stroke-width",1.5).attr("stroke-linejoin","round").attr("stroke-linecap","round").attr("d",nt().curve(J).x(a=>o(a.year)).y(a=>c(a.meanAvg))(t)),l.append("path").attr("fill","none").attr("stroke",xt).attr("stroke-width",1.5).attr("stroke-linejoin","round").attr("stroke-linecap","round").attr("d",nt().curve(J).x(a=>o(a.year)).y(a=>c(a.meanImdbRescaled))(t)),l.append("path").attr("fill","none").attr("stroke",yt).attr("stroke-width",1.5).attr("stroke-dasharray","4,3").attr("stroke-linejoin","round").attr("stroke-linecap","round").attr("d",nt().curve(J).x(a=>o(a.year)).y(a=>c(a.meanMeta))(t)),l.append("g").selectAll("circle").data(t).join("circle").attr("cx",a=>o(a.year)).attr("cy",a=>c(a.meanAvg)).attr("r",3).attr("fill","black").attr("stroke","white").attr("stroke-width",1).append("title").text(a=>`${a.year}: avg ${a.meanAvg.toFixed(1)}, IMDB ${a.meanImdbRescaled.toFixed(1)}, Meta ${a.meanMeta.toFixed(1)} (n=${a.count})`);const s=l.append("g").attr("transform",`translate(${$-k.right-160},${k.top})`);s.append("line").attr("x1",0).attr("x2",20).attr("y1",0).attr("y2",0).attr("stroke","black").attr("stroke-width",1.5),s.append("text").attr("x",24).attr("y",4).text("Average (both)"),s.append("line").attr("x1",0).attr("x2",20).attr("y1",16).attr("y2",16).attr("stroke",xt).attr("stroke-width",1.5),s.append("text").attr("x",24).attr("y",20).text("IMDB (audiences, 0–100)"),s.append("line").attr("x1",0).attr("x2",20).attr("y1",32).attr("y2",32).attr("stroke",yt).attr("stroke-dasharray","4,3").attr("stroke-width",1.5),s.append("text").attr("x",24).attr("y",36).text("Meta (critics, 0–100)")},[t,r,n]),R.jsx("svg",{ref:e,width:$,height:qt,className:"overflow-visible"})}const xn="#3182bd",yn="#e34a33",Mn="#22c55e",bn="#eab308",kn="#e34a33";function wn(t){return t.meanGap>0?xn:yn}function _n(t){const e=Math.abs(t.meanGap);return e<2?Mn:e<4?bn:kn}const vn=100;function Nn(t){return .4+.6*Math.max(0,Math.min(1,t.count/vn))}const Ut=3;function Dn({data:t,showCount:e=!0,caption:r,barOutline:n=!1,opacityByCount:i=!1,boldLabelsByGap:o=!1,boldCountWhenOne:c=!1,highlightZeroLine:l=!1,colorBarsByMagnitude:s=!1}){const a=D.useRef(null),h=Y(t,m=>m.meanGap),f=[Math.min(h[0],0),Math.max(h[1],0)],u=Math.ceil((t.length+.1)*gn)+B.top+B.bottom;return D.useEffect(()=>{if(!a.current||t.length===0)return;const m=O().domain(f).rangeRound([B.left,$-B.right]),p=Kt().domain(t.map(d=>d.genre)).rangeRound([B.top,u-B.bottom]).padding(.1);z(a.current).selectAll("*").remove();const g=z(a.current).attr("viewBox",[0,0,$,u]).attr("style","max-width: 100%; height: auto; font: 10px sans-serif;").style("overflow","visible"),x=g.append("g").selectAll("rect").data(t).join("rect").attr("fill",d=>s?_n(d):wn(d)).attr("x",d=>m(Math.min(d.meanGap,0))).attr("y",d=>p(d.genre)).attr("width",d=>Math.abs(m(d.meanGap)-m(0))).attr("height",p.bandwidth());i&&x.attr("fill-opacity",d=>Nn(d)),n&&x.attr("stroke","currentColor").attr("stroke-width",1).attr("stroke-opacity",.4);const y=g.append("g").attr("font-size",10).selectAll("text").data(t).join("text").attr("text-anchor",d=>d.meanGap<0?"end":"start").attr("x",d=>m(d.meanGap)+(d.meanGap<0?-4:4)).attr("y",d=>p(d.genre)+p.bandwidth()/2).attr("dy","0.35em");y.each(function(d){const w=z(this);c&&e&&d.count===1?(w.append("tspan").text(`${d.meanGap>=0?"+":""}${d.meanGap.toFixed(1)} (n=`),w.append("tspan").attr("font-weight","bold").text("1"),w.append("tspan").text(")")):w.text(e?`${d.meanGap>=0?"+":""}${d.meanGap.toFixed(1)} (n=${d.count})`:`${d.meanGap>=0?"+":""}${d.meanGap.toFixed(1)}`)}),o&&y.attr("font-weight",d=>Math.abs(d.meanGap)>=Ut?"bold":"normal"),g.append("g").attr("transform",`translate(0,${B.top})`).call(Be(m).ticks($/80).tickFormat(d=>Number(d)>=0?`+${d}`:`${d}`)).call(d=>d.selectAll(".tick line").clone().attr("y2",u-B.top-B.bottom).attr("stroke-opacity",.1)).call(d=>d.select(".domain").remove());const v=g.append("g").attr("transform",`translate(${m(0)},0)`).call(rt(p).tickSize(0).tickPadding(6));if(v.selectAll(".tick text").filter((d,w)=>t[w].meanGap<0).attr("text-anchor","start").attr("x",6),o&&v.selectAll(".tick").each(function(d,w){const N=t[w];z(this).select("text").attr("font-weight",N&&Math.abs(N.meanGap)>=Ut?"bold":"normal")}),l){const d=m(0);g.append("line").attr("x1",d).attr("x2",d).attr("y1",B.top).attr("y2",u-B.bottom).attr("stroke","currentColor").attr("stroke-width",2).attr("stroke-opacity",.5),g.append("text").attr("x",d).attr("y",B.top-6).attr("text-anchor","middle").attr("font-size",9).attr("fill","currentColor").text("0"),g.append("text").attr("x",B.left).attr("y",u-B.bottom+14).attr("text-anchor","start").attr("font-size",9).attr("fill","currentColor").attr("opacity",.7).text("Critics higher ←"),g.append("text").attr("x",$-B.right).attr("y",u-B.bottom+14).attr("text-anchor","end").attr("font-size",9).attr("fill","currentColor").attr("opacity",.7).text("→ Audiences higher")}},[t,f,u,e,n,i,o,c,l,s]),R.jsxs("div",{className:"flex flex-col gap-1",children:[r!==null&&R.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:r??"Blue = audiences rate higher than critics on average; red = critics rate higher. Sorted by mean gap. n = number of movies in that genre (with Meta score)."}),R.jsx("svg",{ref:a,width:$,height:u,className:"overflow-visible"})]})}export{Bn as C,Dn as D,Gn as E,jn as a,In as b,Sn as c,An as d,Rn as e,En as f,Vt as g,Tn as h,Cn as i};
